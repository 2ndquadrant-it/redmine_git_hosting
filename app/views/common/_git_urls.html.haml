- content_for :header_tags do
  = stylesheet_link_tag    'git_urls',                    plugin: 'redmine_git_hosting'
  = stylesheet_link_tag    'bootstrap/bootstrap_tooltip', plugin: 'redmine_bootstrap_kit'

  = javascript_include_tag 'plugins/bootstrap_tooltip',   plugin: 'redmine_bootstrap_kit'
  = javascript_include_tag 'plugins/zero_clipboard_min',  plugin: 'redmine_bootstrap_kit'

- repositories = Array.wrap(repository) unless repositories
- if repositories.map(&:available_urls).flatten.reject { |m| m.blank? }.any?
  - repositories.sort_by { |r| r.is_default ? 0 : 1 }.each do |repository|
    - next if repository.available_urls.empty?
    - present repository do |p|
      .repository-urls
        = p.link_to_repository if repositories.count > 1
        = p.git_urls_box

- else
  #git_url_box= l(:label_repository_access_not_configured)

:javascript
  function updateUrl(element) {
    var url = $(element).data('url');
    var target = $(element).data('target');
    var committer = $(element).data('committer');
    $('#git_url_text_' + target).val(url);
    $('#git_url_permissions_' + target).html(committer);
    $(element).parent().find('li').removeClass('selected');
    $(element).addClass('selected');
  }

  function bindGitUrls() {
    $('.git_url').each(function(index, element){
      $(element).on('click', function(){
        updateUrl($(this));
      });
    });
  }

  function setGitUrls() {
    $('.git_url_list').each(function(index, element){
      var first_url = $(element).children().first();
      updateUrl(first_url);
    });
  }

  $(document).ready(function() {
    setGitUrls();
    bindGitUrls();
  });
