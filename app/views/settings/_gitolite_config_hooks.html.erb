<%
  # Gitolite Hooks Config
  gitolite_hooks_are_asynchronous = (!Setting.plugin_redmine_git_hosting.nil? and !Setting.plugin_redmine_git_hosting[:gitolite_hooks_are_asynchronous].nil?) ? Setting.plugin_redmine_git_hosting[:gitolite_hooks_are_asynchronous] : true
  gitolite_force_hooks_update     = (!Setting.plugin_redmine_git_hosting.nil? and !Setting.plugin_redmine_git_hosting[:gitolite_force_hooks_update].nil?)     ? Setting.plugin_redmine_git_hosting[:gitolite_force_hooks_update] : true
  gitolite_hooks_debug            = (!Setting.plugin_redmine_git_hosting.nil? and !Setting.plugin_redmine_git_hosting[:gitolite_hooks_debug].nil?)            ? Setting.plugin_redmine_git_hosting[:gitolite_hooks_debug] : false
%>

<h3><%= l(:label_gitolite_hooks_config) %></h3>

<p>
  <label><%= l(:label_gitolite_hooks_are_asynchronous) %></label>
  <span class="bootstrap-switch switch-small" data-on="primary" data-off="default" data-on-label="<%= l(:label_yes) %>" data-off-label="<%= l(:label_no) %>">
    <%= hidden_field_tag "settings[gitolite_hooks_are_asynchronous]", "false" %>
    <% if gitolite_hooks_are_asynchronous == 'true' %>
      <%= check_box_tag "settings[gitolite_hooks_are_asynchronous]", gitolite_hooks_are_asynchronous, {:checked => "checked"} %>
    <% else %>
      <%= check_box_tag "settings[gitolite_hooks_are_asynchronous]", gitolite_hooks_are_asynchronous %>
    <% end %>
  </span>
</p>

<p>
  <label><%= l(:label_gitolite_force_hooks_update) %></label>
  <span class="bootstrap-switch switch-small" data-on="primary" data-off="default" data-on-label="<%= l(:label_yes) %>" data-off-label="<%= l(:label_no) %>">
    <%= hidden_field_tag "settings[gitolite_force_hooks_update]", "false" %>
    <% if gitolite_force_hooks_update == 'true' %>
      <%= check_box_tag "settings[gitolite_force_hooks_update]", gitolite_force_hooks_update, {:checked => "checked"} %>
    <% else %>
      <%= check_box_tag "settings[gitolite_force_hooks_update]", gitolite_force_hooks_update %>
    <% end %>
  </span>
</p>

<p>
  <label><%= l(:label_gitolite_hooks_debug) %></label>
  <span class="bootstrap-switch switch-small" data-on="primary" data-off="default" data-on-label="<%= l(:label_yes) %>" data-off-label="<%= l(:label_no) %>">
    <%= hidden_field_tag "settings[gitolite_hooks_debug]", "false" %>
    <% if gitolite_hooks_debug == 'true' %>
      <%= check_box_tag "settings[gitolite_hooks_debug]", gitolite_hooks_debug, {:checked => "checked"} %>
    <% else %>
      <%= check_box_tag "settings[gitolite_hooks_debug]", gitolite_hooks_debug %>
    <% end %>
  </span>
</p>

<p>
  <label><%= l(:label_gitolite_hooks_installed) %></label>
  <% hooks = RedmineGitolite::Hooks.new %>
  <% hooks_installed = hooks.check_install %>
  <% hooks_installed.each do |hook, installed| %>
    <%= image_tag((installed == true ? 'true.png' : 'exclamation.png'), :style => "vertical-align:bottom;") %>
    <em><%= hook %></em>
    <br />
  <% end %>
</p>
